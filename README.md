## ¬´–°–∏—Å—Ç–µ–º–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —É—á—ë—Ç–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–∏¬ª  
**–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 10 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥.  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:** C# 12, JetBrains Rider, Avalonia UI 11.1, ASP.NET Core 8 Web API, MySQL 8.0  
**–£—Ä–æ–≤–µ–Ω—å:** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π (full-stack .NET-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

---

## üéØ –¶–ï–õ–¨ –ó–ê–î–ê–ù–ò–Ø
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Ä–æ–ª–µ–π (–±—É—Ö–≥–∞–ª—Ç–µ—Ä/—Å–æ—Ç—Ä—É–¥–Ω–∏–∫), –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (JWT), –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π —É—á—ë—Ç–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ –≥–∏–±–∫–æ–π –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å—é. –ê–∫—Ü–µ–Ω—Ç –Ω–∞:
- –ß–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (—Å–ª–æ–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- –í–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- –û–±—Ä–∞–±–æ—Ç–∫—É –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞–µ–≤
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- UX –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üóÉÔ∏è –ß–ê–°–¢–¨ 1: –ë–ê–ó–ê –î–ê–ù–ù–´–• (MySQL)

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∞ –¥–ª—è –≤—Å–µ—Ö, —Å–µ—Ä–≤–µ—Ä 192.168.200.13, 1135_inventory_system

–ë–∞–∑–∞ –ø—É—Å—Ç–∞—è, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Ä–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
---

## üåê –ß–ê–°–¢–¨ 2: WEB API ‚Äî –ü–û–õ–ù–´–ô –ù–ê–ë–û–† –≠–ù–î–ü–û–ò–ù–¢–û–í

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
Inventory.API/
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îú‚îÄ‚îÄ AuthController.cs
‚îÇ   ‚îú‚îÄ‚îÄ UsersController.cs
‚îÇ   ‚îú‚îÄ‚îÄ EquipmentController.cs
‚îÇ   ‚îú‚îÄ‚îÄ AssignmentsController.cs
‚îÇ   ‚îú‚îÄ‚îÄ InventoryController.cs
‚îÇ   ‚îú‚îÄ‚îÄ ReportsController.cs
‚îÇ   ‚îî‚îÄ‚îÄ DashboardController.cs
‚îú‚îÄ‚îÄ Services/ (IAuthService, IEquipmentService...)
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ DTO/ (Request/Response –æ–±—ä–µ–∫—Ç—ã)
‚îÇ   ‚îú‚îÄ‚îÄ Entities/ (EF Core –º–æ–¥–µ–ª–∏)
‚îÇ   ‚îî‚îÄ‚îÄ Enums/
‚îú‚îÄ‚îÄ Middleware/ (GlobalExceptionHandling)
‚îú‚îÄ‚îÄ Data/ (AppDbContext)
‚îî‚îÄ‚îÄ appsettings.json (JWT, DB, CORS)
```

### üìú –î–ï–¢–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –≠–ù–î–ü–û–ò–ù–¢–´

#### üîí **AuthController** (`[AllowAnonymous]`)
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –¢–µ–ª–æ | –û—Ç–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------|-------|----------|
| `POST` | `/api/auth/login` | `{username, password}` | `{token, userId, role, fullName, expiresIn}` | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| `POST` | `/api/auth/change-password` | `{oldPassword, newPassword}` | `200 OK` | –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è |
| `GET` | `/api/auth/validate` | ‚Äî | `{isValid: true}` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ |

#### üë• **UsersController** (`[Authorize(Roles = "Accountant")]`)
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| `GET` | `/api/users` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–±–µ–∑ –ø–∞—Ä–æ–ª–µ–π) |
| `GET` | `/api/users/employees` | –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (–¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤) |
| `POST` | `/api/users` | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–∞–ª–∏–¥–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏) |
| `PUT` | `/api/users/{id}/deactivate` | –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ |
| `GET` | `/api/users/me` | –î–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

#### üñ•Ô∏è **EquipmentController**
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------|----------|
| `GET` | `/api/equipment` | Accountant | –í—Å–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ + –ø–∞–≥–∏–Ω–∞—Ü–∏—è (`?page=1&pageSize=20&status=...`) |
| `GET` | `/api/equipment/available` | Accountant | –¢–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –¥–ª—è –≤—ã–¥–∞—á–∏ |
| `GET` | `/api/equipment/my` | Employee | –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ —Ç–µ–∫—É—â–µ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É |
| `GET` | `/api/equipment/{id}` | –í—Å–µ | –î–µ—Ç–∞–ª–∏ + –∏—Å—Ç–æ—Ä–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π |
| `POST` | `/api/equipment` | Accountant | –°–æ–∑–¥–∞–Ω–∏–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ InventoryNumber) |
| `PUT` | `/api/equipment/{id}` | Accountant | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–ø—Ä–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è InventoryNumber) |
| `PATCH` | `/api/equipment/{id}/status` | Accountant | –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ |
| `DELETE` | `/api/equipment/{id}` | Accountant | –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (IsActive = false) |

#### üîÑ **AssignmentsController** (`[Authorize]`)
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –¢–µ–ª–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------|----------|
| `POST` | `/api/assignments` | `{equipmentId, employeeId, reason}` | –í—ã–¥–∞—á–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–≤–∞–ª–∏–¥–∞—Ü–∏—è: —Å—Ç–∞—Ç—É—Å=Available, –ª–∏–º–∏—Ç –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞) |
| `POST` | `/api/assignments/{id}/return` | `{reason}` | –í–æ–∑–≤—Ä–∞—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è |
| `GET` | `/api/assignments/history` | `?equipmentId=...&employeeId=...` | –ò—Å—Ç–æ—Ä–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π |
| `GET` | `/api/assignments/current` | ‚Äî | –¢–µ–∫—É—â–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–¥–ª—è –æ—Ç—á—ë—Ç–æ–≤) |

#### üìã **InventoryController**
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------|----------|
| `GET` | `/api/inventory/my` | Employee | –ò—Å—Ç–æ—Ä–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–π —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ |
| `GET` | `/api/inventory/equipment/{id}` | Accountant | –ò—Å—Ç–æ—Ä–∏—è –ø–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é |
| `POST` | `/api/inventory` | Employee | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è: –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ 24—á) |
| `PUT` | `/api/inventory/{id}/correct` | Accountant | –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏ (—Å –ø—Ä–∏—á–∏–Ω–æ–π) |

#### üìä **ReportsController** (`[Authorize(Roles = "Accountant")]`)
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|-----------|----------|
| `GET` | `/api/reports/inventory-summary` | `?employeeId=...&startDate=...&endDate=...` | –°–≤–æ–¥–∫–∞ –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è–º |
| `GET` | `/api/reports/missing-equipment` | `?includeResolved=false` | –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–µ–π IsPresent=false |
| `GET` | `/api/reports/equipment-status` | ‚Äî | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º (–¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º) |
| `GET` | `/api/reports/assignment-history` | `?startDate=...&endDate=...` | –î–µ—Ç–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π |
| `POST` | `/api/reports/export` | `{type: "PDF"|"Excel", ...}` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª) |

#### üìå **DashboardController**
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------|----------|
| `GET` | `/api/dashboard/accountant` | Accountant | –°–≤–æ–¥–∫–∞: –¥–æ—Å—Ç—É–ø–Ω–æ–µ/–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ |
| `GET` | `/api/dashboard/employee` | Employee | –°–≤–æ–¥–∫–∞: –∫–æ–ª-–≤–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –¥–∞—Ç—ã —Å–ª–µ–¥—É—é—â–µ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ |

### üîê –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ë–ò–ó–ù–ï–°-–ü–†–ê–í–ò–õ–ê –í API
```csharp
// –ü—Ä–∏–º–µ—Ä: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏
if (!record.IsPresent) 
    equipment.Status = EquipmentStatus.Missing;
else if (record.Condition == EquipmentCondition.Unusable)
    equipment.Status = EquipmentStatus.UnderRepair;
    
equipment.LastInventoryDate = DateTime.UtcNow;
await _context.InventoryRecords.AddAsync(record);
await _context.SaveChangesAsync();

// –ü—Ä–∏–º–µ—Ä: –ü—Ä–∏ –≤—ã–¥–∞—á–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
if (equipment.Status != EquipmentStatus.Available) 
    throw new ConflictException("–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤—ã–¥–∞—á–∏");
    
var currentAssignments = await _context.Equipment
    .CountAsync(e => e.AssignedToUserId == employeeId && e.IsActive);
if (currentAssignments >= maxLimit) 
    throw new BadRequestException($"–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è ({maxLimit})");
```

### ‚öôÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò API
- **JWT:** lifetime = 2 —á–∞—Å–∞, –ø–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç –∏–∑ `appsettings.json`, refresh token ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 
  - –í—Å–µ –ø–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ BCrypt.Net
  - –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (EF Core)
  - Rate limiting (100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  - CORS: —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–¥–ª–≤–∞—Ä—å —Å –∫–æ–¥–∞–º–∏:
  - `400` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è
  - `401` ‚Äî –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
  - `403` ‚Äî –Ω–µ—Ç –ø—Ä–∞–≤
  - `404` ‚Äî –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
  - `409` ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ)
  - `422` ‚Äî –±–∏–∑–Ω–µ—Å-–æ—à–∏–±–∫–∞
  - `500` ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞

---

## üíª –ß–ê–°–¢–¨ 3: AVALONIA UI (MVVM)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
Inventory.Client/
‚îú‚îÄ‚îÄ Views/
‚îÇ   ‚îú‚îÄ‚îÄ LoginView.axaml
‚îÇ   ‚îú‚îÄ‚îÄ AccountantMainWindow.axaml (–≤–∫–ª–∞–¥–∫–∏: –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è, –û—Ç—á—ë—Ç—ã, –î–∞—à–±–æ—Ä–¥)
‚îÇ   ‚îî‚îÄ‚îÄ EmployeeMainWindow.axaml (–≤–∫–ª–∞–¥–∫–∏: –ú–æ—ë –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è, –ò—Å—Ç–æ—Ä–∏—è)
‚îú‚îÄ‚îÄ ViewModels/ (LoginVM, EquipmentVM, InventoryVM...)
‚îú‚îÄ‚îÄ Models/ (DTO –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îú‚îÄ‚îÄ ApiService.cs (HttpClient + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞)
‚îÇ   ‚îú‚îÄ‚îÄ AuthService.cs (—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –ø–∞–º—è—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ NavigationService.cs
‚îÇ   ‚îî‚îÄ‚îÄ DialogService.cs (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏)
‚îú‚îÄ‚îÄ Converters/ (–¥–ª—è –ø—Ä–∏–≤—è–∑–æ–∫: —Å—Ç–∞—Ç—É—Å ‚Üí —Ü–≤–µ—Ç –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ Assets/ (–∏–∫–æ–Ω–∫–∏, —Ç–µ–º—ã)
‚îî‚îÄ‚îÄ App.axaml.cs (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞)
```

### üñ•Ô∏è –§–£–ù–ö–¶–ò–û–ù–ê–õ –ü–û –†–û–õ–Ø–ú

#### üëî **–ë—É—Ö–≥–∞–ª—Ç–µ—Ä**
- **–î–∞—à–±–æ—Ä–¥:** –ö–∞—Ä—Ç—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (–¥–æ—Å—Ç—É–ø–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏)
- **–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:** 
  - DataGrid —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π, –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  - –ö–Ω–æ–ø–∫–∏ "–í—ã–¥–∞—Ç—å", "–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å"
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è:** 
  - –í—ã–±–æ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ
  - –í—ã–±–æ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
  - –£–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã
- **–û—Ç—á—ë—Ç—ã:**
  - –ì–∏–±–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫, –ø–µ—Ä–∏–æ–¥)
  - –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  - –ö–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF (QuestPDF) / Excel (ClosedXML)

#### üë∑ **–°–æ—Ç—Ä—É–¥–Ω–∏–∫**
- **–î–∞—à–±–æ—Ä–¥:** –°–ø–∏—Å–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –≤ –ø–æ–¥–æ—Ç—á—ë—Ç–µ, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏
- **–ú–æ—ë –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:** 
  - –°–ø–∏—Å–æ–∫ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: –ò–Ω–≤. –Ω–æ–º–µ—Ä, –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏, –°—Ç–∞—Ç—É—Å
  - –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—é" (–∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ Assigned)
- **–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è:**
  - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–ª—è–º–∏:
    - –°–æ—Å—Ç–æ—è–Ω–∏–µ (ComboBox)
    - –ß–µ–∫–±–æ–∫—Å "–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
    - –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (—Ç–µ–∫—Å—Ç)
    - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π)
    - –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–æ—Ç–æ" (FilePicker ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤
- **–ò—Å—Ç–æ—Ä–∏—è:** –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã—Ö –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)

### ‚öôÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò –ö–õ–ò–ï–ù–¢–ê
- **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:** –í –ø–∞–º—è—Ç–∏ (`AuthService`), –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** 
  - –ü—Ä–∏ 401 ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω
  - –ü–æ–Ω—è—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ "500 Internal Server Error")
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –í—Å–µ –≤—ã–∑–æ–≤—ã API —á–µ—Ä–µ–∑ `async/await`, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è:** –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ (—Ä–µ—Å—É—Ä—Å—ã –≤ `Resources.resx`)
- **–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è:** –¢–µ–º–∞ Fluent, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–∞–∫–µ—Ç—ã, –∏–∫–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ `Avalonia.Themes.Fluent`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ UI –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---


### üîë –ö–õ–Æ–ß–ï–í–´–ï –°–¶–ï–ù–ê–†–ò–ò
1. **–í—ã–¥–∞—á–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–æ–º:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `AssignmentHistory` ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `Equipment.AssignedToUserId` –∏ `Status`
2. **–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º:**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è: –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é + –Ω–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–æ–≤–∞–ª–æ—Å—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24—á ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞:**
   - JOIN Equipment, InventoryRecords, Users ‚Üí –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Üí –≤–æ–∑–≤—Ä–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ JSON ‚Üí —ç–∫—Å–ø–æ—Ä—Ç –≤ PDF/Excel –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

---

## üìé –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **API:** 
  - –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL Injection)
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ª–æ–≥–∏–Ω–æ–≤)
- **–ö–ª–∏–µ–Ω—Ç:** 
  - –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –ø–∞–º—è—Ç–∏ (–Ω–∏–∫–∞–∫–∏—Ö —Ñ–∞–π–ª–æ–≤!)
  - –û—á–∏—Å—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (–≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö ‚Äî HTTP —Å –ø–æ–º–µ—Ç–∫–æ–π)


  # üìÑ –ü–†–ò–ú–ï–†–´ –ì–ï–ù–ï–†–ê–¶–ò–ò –û–¢–ß–Å–¢–û–í  
*(–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–µ–µ)*

---

## üìÑ –ü–†–ò–ú–ï–† 1: –ì–ï–ù–ï–†–ê–¶–ò–Ø PDF –ù–ê –°–ï–†–í–ï–†–ï (ASP.NET Core + QuestPDF)

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
```bash
dotnet add package QuestPDF
dotnet add package QuestPDF.Helpers
dotnet add package QuestPDF.Fluent
```

### üíª –ö–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (`ReportsController.cs`)
```csharp
[HttpPost("export")]
[Authorize(Roles = "Accountant")]
public async Task<IActionResult> ExportReport([FromBody] ExportRequest request)
{
    if (request.Type != "PDF") 
        return BadRequest("–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–∏–ø 'PDF' –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞");
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç–∞ –∏–∑ —Å–µ—Ä–≤–∏—Å–∞
    var reportData = await _reportService.GetInventorySummaryAsync(
        request.EmployeeId, 
        request.StartDate, 
        request.EndDate
    );
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º PDF –≤ –ø–∞–º—è—Ç–∏
    var document = Document.Create(container =>
    {
        container.Page(page =>
        {
            page.Size(PageSizes.A4);
            page.Margin(2, Unit.Centimetre);
            page.DefaultTextStyle(x => x.FontSize(10));
            
            page.Header().Element(ComposeHeader);
            page.Content().Element(ComposeContent);
            page.Footer().AlignCenter().Text(text =>
            {
                text.Span("–°—Ç—Ä–∞–Ω–∏—Ü–∞ ");
                text.CurrentPageNumber();
                text.Span(" –∏–∑ ");
                text.TotalPages();
            });
        });
    });
    
    using var stream = new MemoryStream();
    document.GeneratePdf(stream);
    stream.Position = 0;
    
    var fileName = $"InventoryReport_{DateTime.Now:yyyyMMdd_HHmmss}.pdf";
    return File(stream.ToArray(), "application/pdf", fileName);
    
    // --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ---
    void ComposeHeader(IContainer container)
    {
        container.Row(row =>
        {
            row.RelativeItem().Column(col =>
            {
                col.Item().Text("–°–ò–°–¢–ï–ú–ê –ò–ù–í–ï–ù–¢–ê–†–ò–ó–ê–¶–ò–û–ù–ù–û–ì–û –£–ß–Å–¢–ê").FontSize(16).Bold();
                col.Item().Text($"–ü–µ—Ä–∏–æ–¥: {request.StartDate:dd.MM.yyyy} - {request.EndDate:dd.MM.yyyy}")
                    .FontSize(10).FontColor(QuestPDF.Helpers.Colors.Grey.Medium);
                if (request.EmployeeId.HasValue)
                    col.Item().Text($"–°–æ—Ç—Ä—É–¥–Ω–∏–∫: {reportData.EmployeeName}").FontSize(10);
            });
            row.ConstantItem(80).Height(60).Placeholder(); // –õ–æ–≥–æ—Ç–∏–ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        });
    }
    
    void ComposeContent(IContainer container)
    {
        container.PaddingVertical(10).Column(col =>
        {
            // –°–≤–æ–¥–∫–∞
            col.Item().Component<SummaryBox>(reportData.TotalEquipment, "–í—Å–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è");
            col.Item().Component<SummaryBox>(reportData.InventoriedCount, "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ");
            col.Item().Component<SummaryBox>(reportData.MissingCount, "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç", true);
            
            // –¢–∞–±–ª–∏—Ü–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–π
            col.Item().PaddingTop(15).Table(table =>
            {
                table.ColumnsDefinition(columns =>
                {
                    columns.RelativeColumn(); // –ò–Ω–≤. –Ω–æ–º–µ—Ä
                    columns.RelativeColumn(); // –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
                    columns.ConstantColumn(100); // –°–æ—Å—Ç–æ—è–Ω–∏–µ
                    columns.ConstantColumn(80);  // –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
                    columns.ConstantColumn(100); // –î–∞—Ç–∞
                });
                
                // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
                table.Header(header =>
                {
                    header.Cell().Element(CellStyle).Text("–ò–Ω–≤. –Ω–æ–º–µ—Ä").Bold();
                    header.Cell().Element(CellStyle).Text("–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ").Bold();
                    header.Cell().Element(CellStyle).Text("–°–æ—Å—Ç–æ—è–Ω–∏–µ").Bold();
                    header.Cell().Element(CellStyle).Text("–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç").Bold();
                    header.Cell().Element(CellStyle).Text("–î–∞—Ç–∞").Bold();
                });
                
                // –î–∞–Ω–Ω—ã–µ
                foreach (var item in reportData.Details)
                {
                    table.Cell().Element(CellStyle).Text(item.InventoryNumber);
                    table.Cell().Element(CellStyle).Text(item.EquipmentName);
                    table.Cell().Element(CellStyle).Text(item.Condition)
                        .FontColor(item.Condition == "Unusable" ? Colors.Red.Medium : Colors.Green.Dark);
                    table.Cell().Element(CellStyle).Text(item.IsPresent ? "–î–∞" : "–ù–ï–¢")
                        .FontColor(item.IsPresent ? Colors.Green.Dark : Colors.Red.Medium).Bold();
                    table.Cell().Element(CellStyle).Text(item.InventoryDate.ToString("dd.MM.yyyy"));
                }
            });
            
            // –ü–æ–¥–ø–∏—Å—å
            col.Item().PaddingTop(20).AlignRight().Text($"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ: {DateTime.Now:dd.MM.yyyy HH:mm}")
                .FontSize(9).FontColor(Colors.Grey.Medium);
        });
    }
    
    // –°—Ç–∏–ª—å —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
    static IContainer CellStyle(IContainer container) => 
        container.BorderBottom(1).BorderColor(Colors.Grey.Lighten2).Padding(5).AlignCenter();
});

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å–≤–æ–¥–∫–∏
internal class SummaryBox : IComponent
{
    private readonly int _value;
    private readonly string _label;
    private readonly bool _isCritical;
    
    public SummaryBox(int value, string label, bool isCritical = false)
    {
        _value = value; _label = label; _isCritical = isCritical;
    }
    
    public void Compose(IContainer container)
    {
        container
            .Border(1)
            .BorderColor(_isCritical ? Colors.Red.Medium : Colors.Blue.Medium)
            .Background(_isCritical ? Colors.Red.Lighten4 : Colors.Blue.Lighten4)
            .Padding(8)
            .Width(150)
            .Column(col =>
            {
                col.Item().Text(_value.ToString()).FontSize(24).Bold()
                    .FontColor(_isCritical ? Colors.Red.Dark : Colors.Blue.Dark);
                col.Item().Text(_label).FontSize(10).FontColor(Colors.Grey.Dark);
            });
    }
}
```

### üì• –í—ã–∑–æ–≤ –∏–∑ Avalonia (ApiService.cs)
```csharp
public async Task<byte[]> ExportReportAsync(ExportRequest request)
{
    var response = await _httpClient.PostAsJsonAsync("api/reports/export", request);
    response.EnsureSuccessStatusCode();
    return await response.Content.ReadAsByteArrayAsync();
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥
public async Task SaveReportAsync(byte[] fileBytes, string defaultName)
{
    var dialog = new SaveFileDialog
    {
        Title = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á—ë—Ç",
        InitialFileName = defaultName,
        Filters = new List<FileDialogFilter>
        {
            new() { Name = "PDF Document", Extensions = new List<string> { "pdf" } }
        }
    };
    
    var path = await dialog.ShowAsync(MainWindow.Instance);
    if (!string.IsNullOrEmpty(path))
        await File.WriteAllBytesAsync(path, fileBytes);
}
```

---

## üìä –ü–†–ò–ú–ï–† 2: –ì–ï–ù–ï–†–ê–¶–ò–Ø EXCEL –ù–ê –°–ï–†–í–ï–†–ï (ASP.NET Core + ClosedXML)

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
```bash
dotnet add package ClosedXML
dotnet add package DocumentFormat.OpenXml
```

### üíª –ö–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (`ReportsController.cs`)
```csharp
[HttpPost("export-excel")]
[Authorize(Roles = "Accountant")]
public async Task<IActionResult> ExportExcel([FromBody] ExportRequest request)
{
    var reportData = await _reportService.GetInventorySummaryAsync(
        request.EmployeeId, 
        request.StartDate, 
        request.EndDate
    );
    
    using var workbook = new XLWorkbook();
    var worksheet = workbook.Worksheets.Add("–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è");
    
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á—ë—Ç–∞
    worksheet.Cell(1, 1).Value = "–û–¢–ß–Å–¢ –ü–û –ò–ù–í–ï–ù–¢–ê–†–ò–ó–ê–¶–ò–ò –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø";
    worksheet.Range(1, 1, 1, 6).Merge().Style
        .Font.SetBold().FontSize = 14
        .Alignment.SetHorizontal(XLAlignmentHorizontalValues.Center)
        .Fill.SetBackgroundColor(XLColor.FromArgb(42, 113, 192)); // –°–∏–Ω–∏–π —Ñ–æ–Ω
    
    // –ü–µ—Ä–∏–æ–¥ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫
    worksheet.Cell(2, 1).Value = $"–ü–µ—Ä–∏–æ–¥: {request.StartDate:dd.MM.yyyy} - {request.EndDate:dd.MM.yyyy}";
    if (request.EmployeeId.HasValue)
        worksheet.Cell(3, 1).Value = $"–°–æ—Ç—Ä—É–¥–Ω–∏–∫: {reportData.EmployeeName}";
    
    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞—è —Å 5-–π —Å—Ç—Ä–æ–∫–∏)
    var headers = new[]
    {
        "–ò–Ω–≤. –Ω–æ–º–µ—Ä", "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", "–ö–∞—Ç–µ–≥–æ—Ä–∏—è", 
        "–°–æ—Å—Ç–æ—è–Ω–∏–µ", "–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç", "–î–∞—Ç–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏", "–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"
    };
    
    for (int i = 0; i < headers.Length; i++)
    {
        worksheet.Cell(5, i + 1).Value = headers[i];
        worksheet.Cell(5, i + 1).Style
            .Font.SetBold()
            .Fill.SetBackgroundColor(XLColor.LightGray)
            .Alignment.SetHorizontal(XLAlignmentHorizontalValues.Center);
    }
    
    // –î–∞–Ω–Ω—ã–µ
    int row = 6;
    foreach (var item in reportData.Details)
    {
        worksheet.Cell(row, 1).Value = item.InventoryNumber;
        worksheet.Cell(row, 2).Value = item.EquipmentName;
        worksheet.Cell(row, 3).Value = item.Category;
        worksheet.Cell(row, 4).Value = item.Condition;
        
        // –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è "–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
        var presentCell = worksheet.Cell(row, 5);
        presentCell.Value = item.IsPresent ? "–î–∞" : "–ù–ï–¢";
        presentCell.Style.Font.SetBold();
        presentCell.Style.Font.FontColor = 
            item.IsPresent ? XLColor.Green : XLColor.Red;
        
        worksheet.Cell(row, 6).Value = item.InventoryDate;
        worksheet.Cell(row, 6).Style.DateFormat.Format = "dd.mm.yyyy";
        worksheet.Cell(row, 7).Value = item.Location;
        
        row++;
    }
    
    // –ê–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
    worksheet.Columns().AdjustToContents();
    
    // –°–≤–æ–¥–∫–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±–ª–æ–∫–µ
    worksheet.Cell(row + 2, 1).Value = "–°–í–û–î–ö–ê:";
    worksheet.Cell(row + 3, 1).Value = "–í—Å–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:";
    worksheet.Cell(row + 3, 2).Value = reportData.TotalEquipment;
    worksheet.Cell(row + 4, 1).Value = "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:";
    worksheet.Cell(row + 4, 2).Value = reportData.InventoriedCount;
    worksheet.Cell(row + 5, 1).Value = "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:";
    worksheet.Cell(row + 5, 2).Value = reportData.MissingCount;
    worksheet.Cell(row + 5, 2).Style.Font.FontColor = XLColor.Red;
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ MemoryStream
    using var stream = new MemoryStream();
    workbook.SaveAs(stream);
    stream.Position = 0;
    
    var fileName = $"Inventory_{(request.EmployeeId.HasValue ? $"Emp{request.EmployeeId}" : "All")}_{DateTime.Now:yyyyMMdd}.xlsx";
    return File(stream.ToArray(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", fileName);
}
```

### üì• –í—ã–∑–æ–≤ –∏–∑ Avalonia (ApiService.cs)
```csharp
public async Task<byte[]> ExportExcelAsync(ExportRequest request)
{
    var response = await _httpClient.PostAsJsonAsync("api/reports/export-excel", request);
    response.EnsureSuccessStatusCode();
    return await response.Content.ReadAsByteArrayAsync();
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥
public async Task SaveExcelAsync(byte[] fileBytes)
{
    var dialog = new SaveFileDialog
    {
        Title = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å Excel-–æ—Ç—á—ë—Ç",
        InitialFileName = $"Inventory_{DateTime.Now:yyyyMMdd_HHmm}.xlsx",
        Filters = new List<FileDialogFilter>
        {
            new() { Name = "Excel Workbook", Extensions = new List<string> { "xlsx" } }
        }
    };
    
    var path = await dialog.ShowAsync(MainWindow.Instance);
    if (!string.IsNullOrEmpty(path))
        await File.WriteAllBytesAsync(path, fileBytes);
}
```

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –°–ï–†–í–ï–†–ù–û–ô –ì–ï–ù–ï–†–ê–¶–ò–ò
| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è |
|----------|---------------------|----------------------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–µ —É—Ö–æ–¥—è—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç | ‚ùå –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ –°–µ—Ä–≤–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | ‚ùå –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ |
| **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** | ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≤—Å–µ—Ö | ‚ùå –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –û–°/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞ |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** | ‚úÖ –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω | ‚ùå –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | ‚úÖ –¢–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | ‚ùå –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |

---

## üí° –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò
1. **–î–ª—è PDF:**
   - –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è —á–µ—Ä–µ–∑ `Image.FromFile()` –≤ QuestPDF
   - –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ä–∞–∑–±–∏–≤–∫—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ—Ç—á—ë—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `document.GeneratePdfToFile(path)` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

2. **–î–ª—è Excel:**
   - –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ `worksheet.PivotTables.Add(...)`
   - –í–Ω–µ–¥—Ä–∏—Ç–µ —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ (—Ç—Ä–µ–±—É–µ—Ç ClosedXML.Charting)

3. **–í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
   ```csharp
   // –í Program.cs –¥–æ–±–∞–≤—å—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
   builder.Services.Configure<IISServerOptions>(options => 
   {
       options.MaxRequestBodySize = 10 * 1024 * 1024; // 10 –ú–ë
   });
   ```
   ```csharp
   // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞
   if (request.EndDate - request.StartDate > TimeSpan.FromDays(365))
       return BadRequest("–ü–µ—Ä–∏–æ–¥ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å 1 –≥–æ–¥");
   ```
